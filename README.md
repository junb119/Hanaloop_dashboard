# HanaLoop 탄소 인텔리전스 대시보드

## 개요
- Net Zero 이행 조직을 돕기 위한 Scope 1 배출량 모니터링·실행 지원 대시보드입니다.
- 지연·실패 확률이 포함된 가짜 API + in-memory 캐시 구조로 구성해 실제 백엔드로 교체하기 쉽도록 설계했습니다.
- 필터 → KPI → 시각화 → 요약 표 → 실행 로그로 이어지는 정보 흐름을 통해 상황 파악부터 후속 조치 기록까지 한 화면에서 처리합니다.

## 주요 기능
1. **전역 필터**: 회사 다중 선택, 기간(시작/종료), 탄소세 조정. 입력 즉시 KPI/차트/테이블/게시물이 갱신됩니다.
2. **KPI & 시각화**: 최신 월·전월 대비·연초 누적·탄소세 추정, SVG 기반 추세·배출원 차트로 핵심 지표를 제공합니다.
3. **회사 요약**: 데스크톱에서는 표+확장 상세, 모바일에서는 카드+모달 패턴으로 긴 기간도 읽기 쉽게 구성했습니다.
4. **게시물 패널**: 필터와 연동된 목록/폼 + 낙관적 CRUD(작성자 필수, 작성일 자동 기록). 모바일에서는 폼이 모달로 열립니다.
5. **반응형 내비게이션**: 데스크톱 사이드바, 모바일 햄버거 메뉴와 sticky 헤더 조합으로 어디서든 빠르게 이동할 수 있습니다.

## 실행 방법
```bash
npm install
npm run dev
# 브라우저에서 http://localhost:3000/dashboard 접속
```
빌드 확인: `npm run build` → `npm start`

## 테스트 & 품질
- 린트: `npm run lint`
- 추후 확대 시 `vitest` + `@testing-library/react` 기반 단위/통합 테스트 도입을 권장합니다.

## 가정
- 실제 백엔드가 없으므로 `lib/api.ts`의 스텁 API(지연·실패 포함)를 사용합니다.
- 필터 상태만 전역(Zustand)으로 관리하고, 데이터는 in-memory 쿼리/뮤테이션 캐시로 다룹니다.
- 게시물은 감축 활동 로그용으로, 배출량 계산에는 직접 영향을 주지 않습니다.
- 다국어는 고려하지 않고 한국어 UI를 기준으로 합니다.

## 설계 결정
### 데이터 계층
- `types → data → api → queries/mutations → store → transforms` 순으로 경계를 분리해 교체·테스트가 쉽도록 했습니다.
- 쿼리/뮤테이션 헬퍼는 in-memory 캐시를 제공해 로딩/에러/낙관적 업데이트를 일관되게 처리합니다.

### 상태 관리
- 전역 상태는 필터(Zustand)만 담당하고, 나머지는 컴포넌트 로컬 상태와 쿼리 캐시로 해결합니다.
- 게시물 CRUD는 optimistic update + 실패 롤백 + 오류 메시지로 사용자 피드백을 빠르게 줍니다.

### UI/UX
- 상단에서 하단으로 갈수록 정보가 깊어지는 “필터 → KPI → 시각화 → 표 → 행동 로그” 흐름을 유지했습니다.
- 배출원 차트는 합계가 100%가 되도록 보정하고, 최대 배출원을 카드로 강조합니다.
- 게시물 패널은 목록/폼을 분리하고 모바일에서는 모달을 사용해 작은 화면에서도 흐름이 명확합니다.

### 반응형 전략
- **데스크톱**: 사이드 네비 + 2~3열 레이아웃.
- **태블릿**: 사이드 네비 유지, 일부 카드 2열.
- **모바일**: 햄버거 메뉴·sticky 헤더, 회사 요약은 카드+모달, 게시물은 리스트+모달 폼.

## UI/UX 디자인 선택 이유
- **정보 흐름**: 필터를 조정하면 즉시 KPI와 시각화가 변하고, 아래서 세부 데이터·실행 로그를 확인하도록 구성해 자연스러운 탐색 경로를 만들었습니다.
- **배출원 강조**: 최대 배출원을 하이라이트 카드로 보여줌으로써 “먼저 줄여야 할 영역”을 즉시 드러냅니다.
- **게시물 경험**: 목록/폼 분리, 작성자 필수, 작성일 자동 기록으로 실무에서 필요한 감사 추적 요구를 충족합니다.
- **모바일 최적화**: 테이블을 카드/모달로 대체하고, 내비게이션은 sticky 헤더+모달 메뉴로 사용성을 유지합니다.

## 아키텍처 개요
### 상태 경계
- 전역 상태: `src/lib/store.ts`(Zustand)에서 **선택된 회사/기간/탄소세**만 관리.
- 데이터 캐시: `src/lib/queries.ts`의 in-memory 컨트롤러가 API 응답·로딩·에러를 관리.
- 로컬 상태: 게시물 패널 뷰 모드, 요약 표 확장 여부 등은 각 컴포넌트의 `useState`로 분리.

### 데이터 플로우
```
필터 입력 → Zustand → useQuery → fake API → transforms → 대시보드 위젯
                                    ↘
                                     useMutation (게시물)
```
필터 변경이 있으면 재계산된 데이터셋을 KPI/차트/표/게시물이 공유합니다.

## 렌더링 효율성 고려 사항
- KPI/차트/요약 데이터는 `useMemo`로 필터·원본 변경 시에만 재계산합니다.
- 게시물 패널은 목록과 폼을 분리하고 `useMemo`/상태 분리를 통해 필요 영역만 리렌더합니다.
- `useQuery`에서 로딩·에러 상태를 관리해 각 컴포넌트가 최소한의 UI만 갱신합니다.

## 시간 제약과 트레이드오프
- **테이블 시각화**: 막대/스파크라인 대신 월별 카드로 대체(추후 차트 라이브러리 연동 여지). 
- **게시물 태킹/검색**: 범위 밖으로 제외(회사/기간 필터만 지원).
- **자동화 테스트**: lint 외 테스트 미도입. 구조는 `vitest` + RTL 추가를 염두에 둔 상태.

## 총 소요 시간
- 약 11시간 (설계 검토 2h / 데이터·UI 구현 6h / 반응형·Polish 3h)
